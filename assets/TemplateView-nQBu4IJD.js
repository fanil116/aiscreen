import{_ as S,u as U,a as N,r as n,c as k,b as T,d as a,t as C,e as I,w as q,f as u,v as p,g as B,h as D,i as w,o as E}from"./index-DUdxVpT5.js";const H={name:"TemplateView",setup(){const f=D(),e=U(),r=N();let t=n({}),s=n(""),m=n(""),l=n(0),d=n(0),y=f.query.id,g=null,v=n(!1);const h=k(()=>{var i;return((i=e==null?void 0:e.getUser)==null?void 0:i.token)||JSON.parse(localStorage.getItem("User")).token}),b=function(){w.get(`https://dev-api.aiscreen.io/api/v1/canvas_templates/${y}`,{headers:{authorization:`Bearer ${h.value}`}}).then(i=>{Object.assign(t.value,i.data),s.value=t.value.name,l.value=t.value.width,d.value=t.value.height,m.value=t.value.tags.join(", ")})};function V(i){g=i.target.files[0]}const x=async function(){if(l.value<=0||d.value<=0){r.setErrorText("Ширина и высота должны быть больше 0"),r.setVisibleError(!0);return}const i=new FormData;i.append("name",s.value),i.append("width",l.value),i.append("height",d.value),m.value.split(/[, ]+/g).filter(o=>o.trim().length>0).forEach(o=>i.append("tags[]",o)),g&&i.append("image",g);try{await w.post(`https://dev-api.aiscreen.io/api/v1/canvas_templates/${t.value.id}?_method=PATCH`,i,{headers:{"Content-Type":"multipart/form-data",authorization:`Bearer ${h.value}`}}),b(),v.value=!0,setTimeout(()=>{v.value=!1},1500)}catch(o){r.setErrorText(o.message),r.setVisibleError(!0)}};return b(),{data:t,templateWidth:l,templateHeight:d,templateTagsStrings:m,templateName:s,uploadImage:V,submit:x,dataUpdate:v}}},j=["src","alt"],W={class:"template__name"},c={class:"form"},z={key:0,class:"modal"};function F(f,e,r,t,s,m){return E(),T("div",null,[a("img",{src:t.data.preview_image,alt:t.data.name,class:"template__image"},null,8,j),a("div",W,C(t.data.name),1),a("div",c,[e[12]||(e[12]=I(" Edit template ")),a("form",{onSubmit:e[5]||(e[5]=q((...l)=>t.submit&&t.submit(...l),["prevent"]))},[a("div",null,[e[6]||(e[6]=a("label",{for:"name"},"Enter name: ",-1)),u(a("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>t.templateName=l),type:"text",name:"name",id:"name",required:""},null,512),[[p,t.templateName]])]),a("div",null,[e[7]||(e[7]=a("label",{for:"tags"},"Enter tags: ",-1)),u(a("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>t.templateTagsStrings=l),type:"text",name:"tegs",id:"tags",required:""},null,512),[[p,t.templateTagsStrings]])]),a("div",null,[e[8]||(e[8]=a("label",{for:"width"},"Enter width: ",-1)),u(a("input",{"onUpdate:modelValue":e[2]||(e[2]=l=>t.templateWidth=l),type:"number",name:"width",id:"width",required:""},null,512),[[p,t.templateWidth]])]),a("div",null,[e[9]||(e[9]=a("label",{for:"height"},"Enter height: ",-1)),u(a("input",{"onUpdate:modelValue":e[3]||(e[3]=l=>t.templateHeight=l),type:"number",name:"height",id:"height",required:""},null,512),[[p,t.templateHeight]])]),a("div",null,[e[10]||(e[10]=a("label",{for:"image"},"Choose picture:",-1)),a("input",{type:"file",id:"image",name:"image",accept:"image/png, image/jpeg",onChange:e[4]||(e[4]=(...l)=>t.uploadImage&&t.uploadImage(...l))},null,32)]),e[11]||(e[11]=a("button",null,"Отправить",-1))],32)]),t.dataUpdate?(E(),T("div",z,"Данные обновлены")):B("",!0)])}const A=S(H,[["render",F],["__scopeId","data-v-b1121312"]]);export{A as default};
